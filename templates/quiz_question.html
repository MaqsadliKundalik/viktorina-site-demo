{% extends "base.html" %}
{% block title %}{{ quiz.title }} - Savol {{ index|add:1 }}{% endblock %}
{% block content %}

<div style="background: var(--tg-theme-secondary-bg-color, #222e35); border-radius: 18px; box-shadow: 0 2px 8px 0 rgba(0,0,0,0.10); max-width: 420px; margin: 0 auto; padding: 22px 12px 18px 12px;">
  <!-- Progress bar -->
  <div style="margin-bottom: 18px;">
    <div style="display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 0.98rem; font-weight: 500; color: var(--tg-theme-link-color, #61dafb);">
      <span> Savol {{ index|add:1 }} / {{ total }} </span>
      <span> {{ progress }}% </span>
    </div>
    <div style="width: 100%; background: var(--tg-theme-bg-color, #17212b); border-radius: 8px; height: 8px;">
      <div style="background: var(--tg-theme-link-color, #61dafb); height: 8px; border-radius: 8px; width: {{ progress }}%; transition: width 0.5s;"></div>
    </div>
  </div>

  <!-- Savol matni -->
  <div style="font-size: 1.08rem; font-weight: 600; margin-bottom: 18px; color: var(--tg-theme-text-color, #fff); line-height: 1.5;">
    {{ index|add:1 }}. {{ question.text }}
  </div>

  <form method="post" style="display: flex; flex-direction: column; gap: 10px;">
    {% csrf_token %}
    {% for answer in question.answers.all %}
      {% if feedback %}
        {% if feedback.selected_id and answer.id == feedback.selected_id and not feedback.is_correct %}
          <div style="padding: 12px 14px; border-radius: 12px; background: #ffeded; color: #d32f2f; border: 1.5px solid #d32f2f; font-weight: 500; display: flex; align-items: center; gap: 8px;">
            ❌ {{ answer.text }} 
            <span style="font-size: 0.85rem; color: #b0b0b0; margin-left: 6px;">(tanlagan javobingiz)</span>
          </div>
        {% elif answer.id == feedback.correct_id %}
          <div style="padding: 12px 14px; border-radius: 12px; background: #e6f9ed; color: #388e3c; border: 1.5px solid #388e3c; font-weight: 500; display: flex; align-items: center; gap: 8px;">
            ✅ {{ answer.text }} 
            {% if feedback.selected_id == answer.id %}
              <span style="font-size: 0.85rem; color: #b0b0b0; margin-left: 6px;">(tanlagan javobingiz)</span>
            {% endif %}
          </div>
        {% else %}
          <div style="padding: 12px 14px; border-radius: 12px; background: var(--tg-theme-bg-color, #17212b); color: var(--tg-theme-hint-color, #a0a0a0); border: 1.5px solid #232e36; font-weight: 500;">{{ answer.text }}</div>
        {% endif %}
      {% else %}
        <label style="display: block; padding: 12px 14px; border-radius: 12px; background: var(--tg-theme-bg-color, #17212b); color: var(--tg-theme-text-color, #fff); border: 1.5px solid #232e36; font-weight: 500; cursor: pointer; transition: background 0.2s, border 0.2s; margin-bottom: 0;">
          <input type="radio" name="answer" value="{{ answer.id }}" style="display: none;">
          <span style="font-size: 1rem;">{{ answer.text }}</span>
        </label>
      {% endif %}
    {% endfor %}

    {% if feedback %}
      <a href="{% url 'quiz:quiz_question' quiz.id index|add:1 %}"
         style="margin-top: 16px; width: 100%; display: inline-block; padding: 13px 0; background: var(--tg-theme-link-color, #61dafb); color: #fff; text-align: center; border-radius: 12px; font-weight: 600; font-size: 1.08rem; text-decoration: none; transition: background 0.2s;">
        ⏭️ Keyingi savol
      </a>
    {% else %}
      <button type="submit"
              style="margin-top: 16px; width: 100%; padding: 13px 0; background: #30ba6a; color: #fff; border-radius: 12px; font-weight: 600; font-size: 1.08rem; border: none; cursor: pointer; transition: background 0.2s;">
        ✅ Javobni tekshirish
      </button>
    {% endif %}
  </form>
</div>

{% endblock %}
